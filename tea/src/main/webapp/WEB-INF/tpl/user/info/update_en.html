<!DOCTYPE html>
<#import "/common/spring.ftl" as spring />
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="author" content="">

    <title><@spring.message "site"/></title>


    <#include "/common/common-js.html" />
    <!-- Custom styles for this template -->
    <link href="${resource}/bootstrap/b2/css/bootstrap.css" rel="stylesheet">
    <link href="${resource}/bootstrap/b2/css/docs.css" rel="stylesheet">
    <script type="text/javascript" src="${resource}/bootstrap/b2/js/bootstrap-multiselect.js"></script>
    <link rel="stylesheet" href="${resource}/bootstrap/b2/css/bootstrap-multiselect.css" type="text/css"/>
    <script src="${resource}/js/jquery.json-2.4.js"></script>
    <style type="text/css">
        .form-signin-heading {
            border-bottom: solid 3px #e1e1e1;
            padding-bottom: 10px;
            position: relative;
            line-height: 40px;
            color: #d84c31;
            font-size: 24px;
        }

        .rowself {
            width: 680px;
            margin: 30px auto;
            margin-bottom: 50px;
            border: 1px solid #e1e1e1;
            -webkit-box-shadow: 0 0 3px #eee, inset 0 0 3px #fff;
            box-shadow: 0 0 3px #eee, inset 0 0 3px #fff;
            background: #fbfbfb;
            padding: 20px;
            margin-top: 0px;
        }
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }

        .sidebar-nav {
            padding: 9px 0;
        }

        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }
        a {
            color: #eb8300;
            text-decoration: none;
        }
        .nav-list > .active > a,
        .nav-list > .active > a:hover,
        .nav-list > .active > a:focus {
            color: #ffffff;
            text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.2);
            background-color: #eb8300;
        }
    </style>
</head>
<!-- Bootstrap core CSS -->

<body>
<#include "/user/header.html" />
<!-- /.navbar -->
<#assign exhibitor_data_end_html = "${tExhibitorTime.tea_Fair_Data_End_Html}">
<div class="container-fluid">
    <div class="row-fluid" style="width:1000px;margin:0px auto">
        <#include "/user/left.html" />
        <#include "/common/message.ftl" />
        <div class="span9">
            <div class="row-fluid">
                <p class="text-error">
                1.Please fill in this form carefully, all the information you submit here will be used in the Official Catalogue of Xiamen Tea Fair ${tExhibitorTime.tea_Fair_Show_Year}.</br>
                2.Deadline for submitting your company's information is ${tExhibitorTime.exhibitor_Info_Submit_Deadline_En}.</br>
                3.If you could not submit information successfully, please download the form, fill it and send it back to us via Email info@teafair.com.cn , or Fax +86 592 5959611.</br>
                </p>
                <form class="form-horizontal" id="infoform" action="${base}/user/updateinfo" method="post" role="form"
                      enctype="multipart/form-data">
                    <h3 class="form-signin-heading"><@spring.message "info.update.exhibition.title"/></h3>
                    <div style="color: red"><span style="font-weight: bolder;color: red;padding-left: 5px;">*</span><@spring.message "info.must"/></div>
                    <div class="control-group">
                        <label for="inputEmail3" class="control-label" required><@spring.message "info.update.exhibition.company_zh"/></label>

                        <div class="controls">
                            <input type="text" readonly="readonly" catValidate="required:false" name="company" value="${newinfo.company!""}"
                            class="form-control" placeholder='<@spring.message "info.update.exhibition.company_zh"/>'>
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputPassword3" class="control-label"><@spring.message "info.update.exhibition.company_en"/></label>

                        <div class="controls">
                            <input type="text" readonly="readonly" catValidate="required:true" name="companyEn" value="${newinfo.companyEn!""}" class="form-control"
                            id="inputPassword3" placeholder='<@spring.message "info.update.exhibition.company_en"/>'><span style="font-weight: bolder;color: red;padding-left: 5px;">*（Please contact us if you need to modify the Company Name.）</span>
                        </div>
                    </div>
                    <#if booth?exists>
                        <#if booth.boothNumber?exists>
                            <div class="control-group">
                                <label for="inputCheckZh" class="control-label" required><@spring.message "info.update.exhibition.checkno"/></label>
                                <div class="controls">
                                    <input type="text" readonly="readonly" name="checkno" value="${booth.boothNumber!""}"
                                    class="form-control" placeholder='<@spring.message "info.update.exhibition.checkno"/>'>
                                </div>
                            </div>
                        </#if>
                    </#if>
                    <div class="control-group">
                        <label for="inputPhone" class="control-label"><@spring.message "info.update.exhibition.phone"/></label>

                        <div class="controls">
                            <input placeholder="country number" id="inputPhone" catValidate="required:true" name="phoneCountryNumber" type="text" style="width: 25px;" />-<input placeholder="area number" id="areaNumber" name="areaNumber" type="text" style="width: 40px;" />-<input catValidate="required:true" placeholder="phone number" id="phoneNumber" name="phoneNumber" type="text" style="width: 102px;" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputFax" class="control-label"><@spring.message "info.update.exhibition.fax"/></label>

                        <div class="controls">
                            <input placeholder="country number" id="inputFax" catValidate="required:false" name="faxCountryNumber" type="text" style="width: 25px;" />-<input placeholder="area number" catValidate="required:false" id="faxAreaNumber" name="faxAreaNumber" type="text" style="width: 40px;" />-<input catValidate="required:false" placeholder="phone number" id="faxNumber" name="faxNumber" type="text" style="width: 102px;" /><span style="font-weight: bolder;color: red;padding-left: 5px;">*</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputEmail3" class="control-label"><@spring.message "info.update.exhibition.email"/></label>

                        <div class="controls">
                            <input type="email" catValidate="required:true" name="email" value="${newinfo.email!""}" class="form-control" id="inputEmail3"
                            placeholder='<@spring.message "info.update.exhibition.email"/>'><span style="font-weight: bolder;color: red;padding-left: 5px;">*</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputPassword3" class="control-label"><@spring.message "info.update.exhibition.website"/></label>

                        <div class="controls">
                            <input type="text" catValidate="required:false" name="website" value="${newinfo.website!""}" class="form-control"
                            id="inputPassword3" placeholder='<@spring.message "info.update.exhibition.website"/>'>
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputEmail3" class="control-label"><@spring.message "info.update.exhibition.address_zh"/></label>

                        <div class="controls">
                            <input type="text" name="address" value="${newinfo.address!""}" class="form-control"
                            id="inputEmail3" placeholder='<@spring.message "info.update.exhibition.address_zh"/>'>
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputPassword3" class="control-label"><@spring.message "info.update.exhibition.address_en"/></label>

                        <div class="controls">
                            <input type="text" catValidate="required:true" name="addressEn" value="${newinfo.addressEn!""}" class="form-control"
                            id="inputPassword3" placeholder='<@spring.message "info.update.exhibition.address_en"/>'><span style="font-weight: bolder;color: red;padding-left: 5px;">*</span>
                        </div>
                    </div>
                    <!--<div class="control-group">
                        <label for="inputEmail3" class="control-label"><@spring.message "info.update.exhibition.zipcode"/></label>

                        <div class="controls">
                            <input type="text" catValidate="required:false" name="zipcode" value="${newinfo.zipcode!""}" class="form-control"
                            id="inputEmail3" placeholder='<@spring.message "info.update.exhibition.zipcode"/>'>
                        </div>
                    </div>-->
                    <div class="control-group">
                        <label for="inputPassword3" class="control-label"><@spring.message "info.update.exhibition.product_en"/></label>

                        <div class="controls">
                            <input type="text" name="mainProductEn" value="${newinfo.mainProductEn!""}"
                            class="form-control"
                            id="mainProductEn" placeholder='<@spring.message "info.update.exhibition.product_en"/>'><span style="font-weight: bolder;color: red;padding-left: 5px;">less than 15 words</span>
                            <input type="hidden" name="mainProduct" value="${newinfo.mainProduct!''}" id="mainProduct">
                            <!--<input type="hidden" name="mainProductEn" value="${newinfo.mainProductEn!''}" id="mainProductEn">-->
                        </div>
                        <!--&nbsp;&nbsp;&nbsp;&nbsp;
                        &lt;!&ndash; Build your select: &ndash;&gt;
                        <select id="product_en-multiple-select" multiple="multiple">
                            <option value="1">Tea</option>
                            <option value="2">Tea Ware</option>
                            <option value="3">Tea Packaging</option>
                            <option value="4">Tea Processing Equipment</option>
                            <option value="5">Tea Food</option>
                            <option value="6">Tea Testing Service</option>
                            <option value="7">Processed Tea & Tea Products</option>
                            <option value="75">Fuding White Tea Products</option>
                            <option value="8">Others</option>
                        </select>
                        <input type="hidden" name="mainProduct" value="${newinfo.mainProduct!''}" id="mainProduct">
                        <input type="hidden" name="mainProductEn" value="${newinfo.mainProductEn!''}" id="mainProductEn">-->
                    </div>
                    <div class="control-group">
                        <label for="inputMark" class="control-label"><@spring.message "info.update.exhibition.remark"/></label>

                        <div class="controls">
                            <textarea name="mark" cols="40" rows="10" class="form-control" id="inputMark" style="margin: 0px; width: 350px; height: 150px;" placeholder='<@spring.message "info.update.exhibition.remark"/>' onkeydown="countCharEn('inputMark','counterZh');" onkeyup="countCharZh('inputMark','counterZh');">${newinfo.mark!""}</textarea>
                            <span style="font-weight: bolder;color: red;padding-left: 5px;">*</span><span id="counterZh">You can input 300 words</span>
                            <!--<div><@spring.message "info.description.max"/></div>-->
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="inputLogo1" class="control-label"><@spring.message "info.update.exhibition.logo"/></label>

                        <div class="controls">
                            <input type="file" name="companyLogo1" id="inputLogo1" style="display:none" onchange="change(1)"/>
                            <input type="button" id="btn" onclick="document.getElementById('inputLogo1').click();" value="Attach File"/>
                            <!--<input type="file" name="companyLogo1" style="width: 220px;" class="form-control" id="inputLogo1"
                                   placeholder='<@spring.message "info.update.exhibition.logo"/>' onchange="change(1)">-->
                            <span><font color="red">File size less than 200k(support jpg or jpeg format)</font></span>
                        </div>
                    </div>
                    <!--<div class="control-group">
                        <label for="inputLogo2" class="control-label"><@spring.message "info.update.exhibition.logo"/></label>

                        <div class="controls">
                            <input type="file" name="companyLogo2" id="inputLogo2" style="display:none" onchange="change(2)"/>
                            <input type="button" id="btn" onclick="document.getElementById('inputLogo2').click();" value="Attach File"/>
                            &lt;!&ndash;<input type="file" name="companyLogo2" style="width: 220px;" class="form-control" id="inputLogo2"
                                   placeholder='<@spring.message "info.update.exhibition.logo"/>' onchange="change(2)">&ndash;&gt;
                            <span><font color="red">File size less than 200k(support jpg or jpeg format)</font></span>
                        </div>
                    </div>-->
                    <div class="control-group">
                        <div class="controls">
                            <a href="#" class="img-thumbnail">
                                <img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="${base}/user/logoImg?eid=${newinfo.eid}&page=0">
                            </a>
                            <!--<a href="#" class="img-thumbnail">
                                <img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="${base}/user/logoImg?eid=${newinfo.eid}&page=1">
                            </a>-->
                        </div>
                    </div>
                    <hr>
                    <!--<h3 style="color: #d84c31;"><@spring.message "exhibitor.brands"/></h3>-->
                    <!--<div id="brands">-->
                        <!--<#list brands as brand>-->
                            <!--<#if brand.isDefault==0>-->
                                <!--<div name="brand_item" class="alert alert-success" style="width: 250px"><button type="button" class="close" data-dismiss="alert">&times;</button><input bid="${brand.id}" value="${brand.brandName!""}" type="text" style="width: 200px;height: 20px" /></div>-->
                                <!--<#else>-->
                                    <!--<div name="brand_item" style="width: 250px;display: none"><button type="button" class="close" data-dismiss="alert">&times;</button><input bid="${brand.id}" value="${brand.brandName!""}" type="text" style="width: 200px;height: 20px" /></div>-->
                            <!--</#if>-->
                        <!--</#list>-->
                    <!--</div>-->
                    <!--<button id="addBrandButton" class="btn btn-mini" type="button"><@spring.message "info.addbrands"/></button>-->
                    <!--<hr>-->
                    <!--<h3 style="color: #d84c31;display: none"><@spring.message "info.productRange"/></h3>-->
                    <!--<div class="row-fluid" style="display: none">-->
                        <!--<div class="span5">-->
                            <!--<ul class="nav nav-list bs-docs-sidenav">-->
                                <!--<#list types as type>-->
                                    <!--<li><a role="parent" id="${type.id}" sort="parent_${type_index}"-->
                                           <!--href="javascript:void(0)">-->
                                        <!--<i class="icon-chevron-right pull-right"></i>-->
                                        <!--<span name="selectedCount" id="parent_count_${type.id}" count="0"-->
                                              <!--class="badge pull-right hide"></span>-->
                                        <!--${type.typeName}-->
                                    <!--</a>-->
                                    <!--</li>-->
                                <!--</#list>-->
                            <!--</ul>-->
                        <!--</div>-->
                        <!--<div class="span5">-->
                            <!--<#list types as type>-->
                                <!--<div role="childContainer" sort="child_${type_index}" parentId="${type.id}"-->
                                     <!--class="nav nav-list bs-docs-sidenav hide">-->
                                    <!--<#list type.childrenTypes as ctype>-->
                                        <!--<li><a id="subTypeId_${ctype.id}" role="child" parentId="${type.id}"-->
                                               <!--subTypeId="${ctype.id}"-->
                                               <!--other="${ctype.isOther!"0"}" href="javascript:void(0)"-->
                                            <!--class="list-group-item">-->
                                            <!--<i class="icon-ok pull-right hide"></i>-->
                                            <!--${ctype.typeName}-->
                                            <!--</a>-->
                                        <!--</li>-->
                                    <!--</#list>-->
                                    <!--<textarea id="child_other_${type.id}" style="margin-top: 10px;width: 245px"-->
                                              <!--class="form-control hide" placeholder="其他产品类型描述"></textarea>-->
                                <!--</div>-->
                            <!--</#list>-->
                        <!--</div>-->
                    <!--</div>-->
                    <#if exhibitor_data_end_html?date gt .now?date>
                        <button type="button" style="margin-top: 10px;" name="previewCatagory" class="btn btn-warning"><@spring.message "info.update.exhibition.preview"/></button>
                        <button type="button" style="margin-top: 10px;margin-left: 10px" id="saveButton" name="saveButton" class="btn btn-warning"><@spring.message "info.modifypassword.save"/></button>
                    </#if>
                    <input name="einfoid" value="${newinfo.einfoid!""}" type="hidden">
                    <input name="logo" value="${newinfo.logo!""}" type="hidden">
                    <input name="classjson" id="classjson" type="hidden">
                    <input name="brandsData" id="brandsData" type="hidden">
                    <input name="phone" type="hidden" />
                    <input name="fax" type="hidden" />
                </form>
            </div>
            <!--/row-->
        </div>
        <!--/span-->

    </div>
    <!--/row-->


</div>
<#include "/footer.html" />
<!--/.container-->

    <div class="modal hide fade" id="preview" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-head">
                    <img src="${base}/resource/exhibitor_info_head.png">
                </div>
                <div class="modal-body-center-booth" style="margin-left: 30px; margin-right: 70px; margin-top: 10px;"></div>
                <div class="modal-body-center-logo" style="margin-left: 70px; margin-right: 70px;">
                    <#if newinfo?exists>
                        <#if newinfo.logo?exists && newinfo.logo!=''>
                            <img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="${base}/user/logoImg?eid=${newinfo.eid}&page=0" id="previewLogoShow1" name="preview1" />
                            <!--<img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="${base}/user/logoImg?eid=${newinfo.eid}&page=1" id="previewLogoShow2" name="preview2" />-->
                        <#else>
                            <img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="" id="previewLogo" name="previewLogo" class="img-rounded" />
                        </#if>
                    <#else>
                        <img style="width: 100px;height: 100px" data-src="holder.js/100x100" src="" id="previewLogo" name="previewLogo" class="img-rounded" />
                    </#if>
                </div>

                <div class="modal-body-center-companyZh" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-companyEn" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-addressZh" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-addressEn" style="margin-left: 135px; margin-right: 70px;"></div>
                <div class="modal-body-center-tel" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-fax" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-website" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-email" style="margin-left: 70px; margin-right: 70px;"></div>
                <div class="modal-body-center-mainproduct" style="margin-left: 70px;margin-top: 15px; margin-right: 70px;">主营产品/Special Products: </div>
                <div class="modal-body-center-mainproductvalueEn" style="margin-left: 70px; margin-right: 70px;"></div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"><@spring.message "close"/></button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
<script>
    $(document).ready(function(){
        $("#leftInfo").parent().parent().parent().parent().prev().addClass("left_current");
        $("#leftInfo").addClass("active");
        $("#leftInfo").parent().parent().parent().parent().show();

        var fax = '${newinfo.fax!""}';
        var f = '';
        var _f = '';
        if(fax.indexOf(",") >= 0){
            f = fax.split(",");
            if(f.length>1){
                _f = f[0].split("-");
                if(_f.length == 3){
                    $("[name='faxCountryNumber']").val(_f[0]);
                    $("[name='faxAreaNumber']").val(_f[1]);
                    $("[name='faxNumber']").val(_f[2]);
                }else if(_f.length == 2){
                    $("[name='faxAreaNumber']").val(_f[0]);
                    $("[name='faxNumber']").val(_f[1]);
                }else{
                    $("[name='faxNumber']").val(f[0]);
                }
            }
        }else if(fax.indexOf("，") >= 0){
            f = fax.split("，");
            if(f.length>1){
                _f = f[0].split("-");
                if(_f.length == 3){
                    $("[name='faxCountryNumber']").val(_f[0]);
                    $("[name='faxAreaNumber']").val(_f[1]);
                    $("[name='faxNumber']").val(_f[2]);
                }else if(_f.length == 2){
                    $("[name='faxAreaNumber']").val(_f[0]);
                    $("[name='faxNumber']").val(_f[1]);
                }else{
                    $("[name='faxNumber']").val(f[0]);
                }
            }
        }else{
            f = fax.split("-");
            if(f.length == 3){
                $("[name='faxCountryNumber']").val(f[0]);
                $("[name='faxAreaNumber']").val(f[1]);
                $("[name='faxNumber']").val(f[2]);
            }else if(f.length == 2){
                console.log("2");
                $("[name='faxAreaNumber']").val(f[0]);
                $("[name='faxNumber']").val(f[1]);
            }else{
                $("[name='faxNumber']").val(fax);
            }
        }

        var phone = '${newinfo.phone!""}';
        var p = '';
        var _p = '';
        if(phone.indexOf(",") >= 0){
            p = phone.split(",");
            if(p.length>1){
                _p = p[0].split("-");
                if(_p.length == 3){
                    $("[name='phoneCountryNumber']").val(_p[0]);
                    $("[name='areaNumber']").val(_p[1]);
                    $("[name='phoneNumber']").val(_p[2]);
                }else if(_f.length == 2){
                    $("[name='areaNumber']").val(_p[0]);
                    $("[name='phoneNumber']").val(_p[1]);
                }else{
                    $("[name='phoneNumber']").val(phone[0]);
                }
            }
        }else if(phone.indexOf("，") >= 0){
            p = phone.split("，");
            if(p.length>1){
                _p = p[0].split("-");
                if(_p.length == 3){
                    $("[name='phoneCountryNumber']").val(_p[0]);
                    $("[name='areaNumber']").val(_p[1]);
                    $("[name='phoneNumber']").val(_p[2]);
                }else if(_f.length == 2){
                    $("[name='areaNumber']").val(_p[0]);
                    $("[name='phoneNumber']").val(_p[1]);
                }else{
                    $("[name='phoneNumber']").val(phone[0]);
                }
            }
        }else{
            p = phone.split("-");
            if(p.length == 3){
                $("[name='phoneCountryNumber']").val(p[0]);
                $("[name='areaNumber']").val(p[1]);
                $("[name='phoneNumber']").val(p[2]);
            }else if(f.length == 2){
                $("[name='areaNumber']").val(p[0]);
                $("[name='phoneNumber']").val(p[1]);
            }else{
                $("[name='phoneNumber']").val(phone);
            }
        }
    });
</script>
<script>
    function change(index) {
        var pic = "";
        var file = "";
        if(index == 1){
            pic = document.getElementById("previewLogo1");
            file = document.getElementById("inputLogo1");
        }/* else if(index == 2) {
            pic = document.getElementById("previewLogo2");
            file = document.getElementById("inputLogo2");
        }*/
        var ext = file.value.substring(file.value.lastIndexOf(".")+1).toLowerCase();

        // gif在IE浏览器暂时无法显示
        if(ext!='jpg' && ext!='jpeg'){
            alert("File must be in JPG or JPEG format！"); return;
        }

        var  browserCfg = {};
        var ua = window.navigator.userAgent;
        if (ua.indexOf("MSIE")>=1){
            browserCfg.ie = true;
        }else if(ua.indexOf("Firefox")>=1){
            browserCfg.firefox = true;
        }else if(ua.indexOf("Chrome")>=1){
            browserCfg.chrome = true;
        }

        var filesize = 0;
        if(browserCfg.firefox || browserCfg.chrome ){
            filesize = file.files[0].size;
        }else if(browserCfg.ie){
            //转到JAVA后台处理
        }

        if(filesize/1024 > 1024){
            alert("文件大小超过1M，请重新选择图片！");
            return;
        }
        // IE浏览器
        if(document.all){
            file.select();
            var reallocalpath = document.selection.createRange().text;
            var ie6 = /msie 6/i.test(navigator.userAgent);
            // IE6浏览器设置img的src为本地路径可以直接显示图片
            if(ie6){
                pic.src = reallocalpath;
            }else{
                // 非IE6版本的IE由于安全问题直接设置img的src无法显示本地图片，但是可以通过滤镜来实现
                pic.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image',src=\"" + reallocalpath + "\")";
                // 设置img的src为base64编码的透明图片 取消显示浏览器默认图片
                pic.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==';
            }
        }else{
            html5Reader(file, index);
        }
    }

    function html5Reader(file, index){
        var file = file.files[0];
        var reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = function(e){
            if(index == 1){
                var pic = document.getElementById("previewLogo1");
                pic.src = this.result;
            }/*else if(index == 2) {
                var pic = document.getElementById("previewLogo2");
                pic.src = this.result;
            }*/
        }
    }

    selected = eval('${selected}');
    function initShowSelectedCount() {
        $("[name='selectedCount']").each(function () {
            if (parseInt($(this).attr("count")) > 0) {
                $(this).text(words.selected + parseInt($(this).attr("count")));
                $(this).removeClass("hide");
            } else {
                $(this).addClass("hide");
            }
        });
    }
    function countCharEn(textareaName,spanName){
        if(document.getElementById(textareaName).value.length >= 300){
            document.getElementById(spanName).innerHTML = "You input more than 300 words";
            document.getElementById(textareaName).value = document.getElementById(textareaName).value.substring(0, 300);
            $("#counterZh").css("color","#e9322d");
            $("#inputMark").css("border-color","#e9322d");
        }else{
            document.getElementById(spanName).innerHTML = "You can input " + (300 - document.getElementById(textareaName).value.length) + "words";
            $("#counterZh").css("color","#000");
            $("#inputMark").css("border-color","rgba(82, 168, 236, 0.8)");
        }
    }
    $(document).ready(function () {
        document.getElementById('counterZh').innerHTML = "You can input " + (300 - document.getElementById('inputMark').value.length) + "words";
        $("#counterZh").css("color","#000");
        $("#inputMark").css("border-color","rgba(82, 168, 236, 0.8)");

        $("a[sort='parent_0']").parent().addClass("active");
        $("div[sort='child_0']").removeClass("hide");
        //load exhibitor class info
        $(selected).each(function () {
            $("#parent_count_" + this.parentTypeId).attr("count", parseInt($("#parent_count_" + this.parentTypeId).attr("count")) + 1);
            $($("#subTypeId_" + this.subTypeId).children()[0]).removeClass("hide")
            if (this.isOther != null && this.isOther == 1) {
                $("#child_other_" + this.parentTypeId).removeClass("hide");
                $("#child_other_" + this.parentTypeId).text(this.otherDescription);
            }
        });
        initShowSelectedCount();
        //parent type click event handle
        $("[role='parent']").click(function () {
            $("[role='parent']").each(function () {
                $(this).parent().removeClass("active");
            });
            $(this).parent().addClass("active");
            $("[role='childContainer']").each(function () {
                $(this).addClass("hide");
            })
            $("div[parentId='" + $(this).attr("id") + "']").removeClass("hide");
        });

        //children type click event handle
        $("[role='child']").click(function () {
            if ($(this).attr("other") == 1) {
                if ($("#child_other_" + $(this).attr("parentId")).hasClass("hide")) {
                    $("#child_other_" + $(this).attr("parentId")).removeClass("hide");
                } else {
                    $("#child_other_" + $(this).attr("parentId")).addClass("hide");
                }
            }
            if ($($(this).children()[0]).hasClass("hide")) {
                $($(this).children()[0]).removeClass("hide");
                $("#parent_count_" + $(this).attr("parentId")).attr("count", parseInt($("#parent_count_" + $(this).attr("parentId")).attr("count")) + 1);
            } else {
                $($(this).children()[0]).addClass("hide");
                $("#parent_count_" + $(this).attr("parentId")).attr("count", parseInt($("#parent_count_" + $(this).attr("parentId")).attr("count")) - 1);
            }
            initShowSelectedCount();
        });
        //save event
        $("[name='saveButton']").click(function () {
            nowSelected = new Array();
            request = {"selected": nowSelected}
            //find all selected
            $("[role='child']").each(function () {
                if (!$($(this).children()[0]).hasClass("hide")) {
                    //no hide. selected
                    selectItem = {};
                    selectItem.parentTypeId = $(this).attr("parentid");
                    selectItem.subTypeId = $(this).attr("subTypeId");
                    selectItem.isOther = $(this).attr("other");
                    if (selectItem.isOther == 1) {
                        selectItem.otherDescription = $("#child_other_" + $(this).attr("parentid")).val();
                        if(selectItem.otherDescription==''){
                            alert("选择“其他”，描述不能为空")
                            return;
                        }
                    }
//                    console.log(selectItem);
                    nowSelected.push(selectItem);
                }
            });
            $("#classjson").val($.toJSON(request));
            var brands = new Array();
            $("#brands input").each(function(){
                brands.push({"brandName":$(this).val(),"id":$(this).attr("bid")});
            })
            $("#brandsData").val($.toJSON(brands));

            var isCompanyIsNull=false;
            var isCompanyEnIsNull=false;
            function needValidate(o){
                /*if($("#infoform [name='"+o.name+"']").attr("catValidate")==undefined){
                    return false;
                }else{
                    return $("#infoform [name='"+o.name+"']").attr("catValidate").indexOf("required:true")!=-1;
                }*/
                if(o.name=='fax'||o.name=='website'/*||o.name=='zipcode'*/|| o.name=='mark'){
                    return false;
                }
                if(o.name=='areaNumber' || o.name=='faxCountryNumber' || o.name=='faxAreaNumber' || o.name=='faxNumber'){
                    return false;
                }
                if($("#infoform [name='"+o.name+"']").attr("placeholder")==undefined){
                    return false;
                }

                if((o.name=='company' && o.value!='')){
                    isCompanyIsNull = false;
                }
                if((o.name=='company' && o.value=='')){
                    isCompanyIsNull = true;
                }
                if((o.name=='companyEn' && o.value!='')){
                    isCompanyEnIsNull = false;
                }
                if((o.name=='companyEn' && o.value=='')){
                    isCompanyEnIsNull = true;
                }
                if(isCompanyIsNull && isCompanyEnIsNull){
                    return true;
                }
            }
            var formData = $("#infoform").serializeArray();
            for(var i=0;i<formData.length;i++){
                if(formData[i].value==''&& needValidate(formData[i])){
                    alert($("#infoform [name='"+formData[i].name+"']").attr("placeholder")+words.isRequired+" ！");
                    return;
                }
                if((formData[i].name=='mainProductEn' && formData[i].value.length >15)){
                    alert("Main product's content more than 15 words! Please reinput it.");
                    return;
                }
            }
            var phone = $("[name='phoneCountryNumber']").val()+"-"+$("[name='areaNumber']").val()+"-"+$("[name='phoneNumber']").val();
            var fax = $("[name='faxCountryNumber']").val()+"-"+$("[name='faxAreaNumber']").val()+"-"+$("[name='faxNumber']").val();
            $("[name='phone']").val(phone);
            $("[name='fax']").val(fax);
            $("#infoform").submit();
        });

        $("[name='previewCatagory']").click(function(){
            var boothNum  = "";
            <#if booth?exists>
                <#if booth.boothNumber?exists>
                    boothNum = '${booth.boothNumber}';
                </#if>
            </#if>
            var productSelectValue = $("[name='mainProductEn']").val();
            /*$("#product_en-multiple-select option:selected").each(function(){
                productSelectValue = productSelectValue + $(this).text() + ","; //这里得到的就是
            });
            if(productSelectValue != ""){
                var lastIndex = productSelectValue.lastIndexOf(",");
                productSelectValue = productSelectValue.substr(0,lastIndex);
            }*/

            $("#preview .modal-body-center-booth").html("");
            $("#preview .modal-body-center-companyZh").html("");
            $("#preview .modal-body-center-companyEn").html("");
            $("#preview .modal-body-center-addressZh").html("");
            $("#preview .modal-body-center-addressEn").html("");
            $("#preview .modal-body-center-tel").html("");
            $("#preview .modal-body-center-fax").html("");
            $("#preview .modal-body-center-website").html("");
            $("#preview .modal-body-center-email").html("");
            $("#preview .modal-body-center-mainproductvalueEn").html("");


            $("#preview .modal-body-center-booth").append(boothNum);
            var companyNameZh = $("[name='company']").val();
            var companyNameEn = $("[name='companyEn']").val();
            var addressZh = $("[name='address']").val();
            var addressEn = $("[name='addressEn']").val();
            var tel = $("[name='phoneCountryNumber']").val()+"-"+$("[name='areaNumber']").val()+"-"+$("[name='phoneNumber']").val();
            var fax = $("[name='faxCountryNumber']").val()+"-"+$("[name='faxAreaNumber']").val()+"-"+$("[name='faxNumber']").val();
            var website = $("[name='website']").val();
            var email = $("[name='email']").val();
            $("#preview .modal-body-center-companyZh").append("<b>" + companyNameZh + "</b>");
            $("#preview .modal-body-center-companyEn").append("<b>" + companyNameEn + "</b>");
            $("#preview .modal-body-center-addressZh").append("地址/Add: " + addressZh);
            $("#preview .modal-body-center-addressEn").append(addressEn);
            $("#preview .modal-body-center-tel").append("电话/Tel: " + tel);
            $("#preview .modal-body-center-fax").append("传真/Fax: " + fax);
            $("#preview .modal-body-center-website").append("网址/Web: " + website);
            $("#preview .modal-body-center-email").append("邮箱/E-mail: " + email);

            $("#preview .modal-body-center-mainproductvalueEn").append(productSelectValue);

            $("#preview").modal();
        });

        $("#addBrandButton").click(function(){
            var item = '<div name="brand_item" class="alert alert-success" style="width: 250px"><button type="button" class="close" data-dismiss="alert">&times;</button><input type="text" style="width: 200px;height: 20px" /></div>';
            $("#brands").append(item);
        });

    });
</script>
<!-- Initialize the plugin: -->
<script type="text/javascript">
    /*$(document).ready(function() {
        $('#product_en-multiple-select').multiselect({
            onChange: function(option, checked, select) {
                document.getElementById("mainProductEn").value = '';
                document.getElementById("mainProduct").value = '';
                $("#product_en-multiple-select").find('option:selected').each(function() {
                    document.getElementById("mainProductEn").value = document.getElementById("mainProductEn").value + ',' + $(this).val();
                });
                document.getElementById("mainProductEn").value = document.getElementById("mainProductEn").value.substr(1,document.getElementById("mainProductEn").value.length);
                //console.log(document.getElementById("mainProductEn").value);
                document.getElementById("mainProduct").value = document.getElementById("mainProductEn").value;
            }
        });
        var mainProductEn = document.getElementById("mainProductEn").value.split(',');
        $('#product_en-multiple-select').multiselect('select', mainProductEn);
    });*/
</script>
<script src="${resource}/bootstrap/b2/js/bootstrap.js"></script>
</body>
</html>